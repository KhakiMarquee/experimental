import{p as Z}from"./ui-CTue3Ljv.js";function S(t,o){t.classList.add("expanding"),window.p5Instance&&window.p5Instance.noLoop();const a=t.getBoundingClientRect(),s=a.top+window.scrollY,e=a.left+window.scrollX,d=a.width,l=a.height;t.parentElement,t.nextSibling,t.style.transition="none",t.style.position="fixed",t.style.top=`${s}px`,t.style.left=`${e}px`,t.style.width=`${d}px`,t.style.height=`${l}px`,t.style.margin="0",t.style.transform="none",t.style.zIndex="10000",t.style.willChange="top,left,width,height,transform",document.body.appendChild(t),t.getBoundingClientRect();const r=600;t.style.transition=`top ${r}ms ease, left ${r}ms ease, width ${r}ms ease, height ${r}ms ease, transform ${r}ms ease`,t.style.top="0px",t.style.left="0px",t.style.width="100vw",t.style.height="100vh",t.classList.add("fullscreen");const u=h=>{h.target===t&&t.classList.contains("fullscreen")&&(t.removeEventListener("transitionend",u),t.style.willChange="",P(o))};t.addEventListener("transitionend",u),setTimeout(()=>{document.body.contains(t)&&P(o)},r+50)}function P(t){document.body.innerHTML=`
    <div id="detail-app" style="min-height:100vh; display:flex; flex-direction:column; padding:24px; box-sizing:border-box;">
      <button id="close-detail" aria-label="Close" style="align-self:flex-end; font-size:1.25rem; background:none; border:none; cursor:pointer;">âœ•</button>
      <main style="max-width:960px; width:100%; margin:0 auto;">
        <h1 style="margin:0 0 12px 0;">${t.title}</h1>
        <p style="margin:0 0 8px 0;"><strong>Material:</strong> ${t.material??""}</p>
        <p style="margin:0 0 16px 0;">${t.description??""}</p>
        ${t.image?`<img src="${t.image}" alt="${t.title}" style="max-width:100%; height:auto; display:block;">`:""}
      </main>
    </div>
  `,document.getElementById("close-detail").addEventListener("click",()=>{location.reload()})}const F=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(t=>t.json()).then(t=>{const o=document.querySelector("#carousel");if(!o){console.error("Carousel element not found");return}o.innerHTML="",t.forEach(a=>{const s=document.createElement("div");s.classList.add("slide");const e=document.createElement("div");e.classList.add("slide-inner");const d=document.createElement("img");d.src=a.image||"",d.alt=a.title||"";const l=document.createElement("p");l.textContent=a.title||"";const r=document.createElement("span");r.classList.add("tooltip"),r.title="[TAP]",e.appendChild(d),e.appendChild(l),s.appendChild(e),s.appendChild(r),o.appendChild(s),F()?N(s,a):s.addEventListener("click",()=>S(s,a))})}).catch(t=>{console.error("Error loading stone data:",t)})});function N(t,o){let e=0,d=0,l=0,r=!1;t.addEventListener("touchstart",u=>{const h=u.changedTouches[0];d=h.clientX,l=h.clientY,r=!1},{passive:!0}),t.addEventListener("touchmove",u=>{const h=u.touches[0];h&&Math.hypot(h.clientX-d,h.clientY-l)>8&&(r=!0)},{passive:!0}),t.addEventListener("touchend",()=>{const u=Date.now(),h=u-e<300;!r&&h?(S(t,o),e=0):r?e=0:e=u})}function G(t){let o,a=[],s=0,e=0;const d=900;let l=!1;const r=100;let u=0;t.setup=function(){t.noCanvas(),o=document.getElementById("carousel"),a=Array.from(document.querySelectorAll(".slide"));const p=document.getElementById("carousel-container");p.style.perspective="2000px",o.style.transformStyle="preserve-3d",h()?Y():I(),t.loop()},t.draw=function(){o.style.transform="rotateX(-15deg) rotateY(-30deg)";const i=a.length*d;s+=e,s=s%i,s<0&&(s+=i);const f=s/i,b=document.querySelector(".progress-dot");b&&(f>=.8?b.style.backgroundColor="var(--grey-800)":b.style.backgroundColor="rgba(var(--grey-100), 0.4)"),a.forEach((m,C)=>{let v=(C*d-s)%i;v<-d*2&&(v+=i);let X=v-i,$=v+i,g=v;const w=window.innerWidth/2;Math.abs(X-w)<Math.abs(g-w)&&(g=X),Math.abs($-w)<Math.abs(g-w)&&(g=$);const j=g,H=g*-.5,R=-Math.abs(g)*.2,U=Math.round(j*100)/100,z=Math.round(H*100)/100,V=Math.round(R*100)/100;m.classList.contains("expanding")||m.classList.contains("fullscreen")||(m.style.transform=`
        translateX(${U}px)
        translateY(${z}px)
        translateZ(${V}px)
      `)});const y=Math.abs(e);let E;if(y>25)E=.88;else if(y>10){const m=(y-10)/15,C=m*m*(3-2*m);E=.92+(.88-.92)*C}else if(y>2)E=.92;else if(y>.5){const m=(y-.5)/1.5;E=.94+(.92-.94)*m}else E=.94;e*=E,Math.abs(e)<.005&&(e=0)};function h(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function I(){const n=document.querySelector("footer, .footer"),p=document.querySelector("header, .header, .site-header"),c=document.getElementById("carousel-container");c&&(c.addEventListener("mouseenter",()=>{l=!1}),c.addEventListener("mouseleave",()=>{l=!1,e*=.7}),c.addEventListener("wheel",k,{passive:!1}),c.addEventListener("mousedown",q),c.addEventListener("mouseup",_),c.addEventListener("mousemove",W)),[n,p].forEach(i=>{i&&(i.addEventListener("wheel",f=>{f.stopPropagation(),f.preventDefault()},{passive:!1}),i.addEventListener("mousedown",f=>{f.stopPropagation()}),i.addEventListener("mousemove",f=>{f.stopPropagation()}))})}function Y(){const n=document.getElementById("carousel-container");n&&(n.addEventListener("touchstart",O,{passive:!1}),n.addEventListener("touchmove",B,{passive:!1}),n.addEventListener("touchend",D),n.addEventListener("touchcancel",D))}let L=!1;function O(n){n.touches.length===1&&(l=!0,L=!0,u=n.touches[0].clientX,e=0)}function B(n){if(!L||n.touches.length!==1)return;n.preventDefault();const p=n.touches[0].clientX;let i=(p-u)*-1.5;const f=50;i=Math.max(-f,Math.min(f,i)),e=e+(i-e)*.7,u=p}function D(n){L&&(n.preventDefault(),l=!1,L=!1)}let x=0;function k(n){n.preventDefault(),n.stopPropagation();let p=-n.deltaY/8;const c=8;p=Math.max(-c,Math.min(c,p));const i=e+p;e=e+(i-e)*.6,e=Math.max(-r*.8,Math.min(r*.8,e))}function q(n){n.preventDefault(),n.stopPropagation(),l=!0,x=n.clientX}function _(n){n.preventDefault(),n.stopPropagation(),l=!1}function W(n){if(l){n.preventDefault(),n.stopPropagation();let c=(n.clientX-x)*-1.2;const i=15;c=Math.max(-i,Math.min(i,c)),e=e+(c-e)*.7,e=Math.max(-r*.8,Math.min(r*.8,e)),x=n.clientX}}t.mouseWheel=function(n){return!1},t.mousePressed=function(){return!1},t.mouseReleased=function(){return!1},t.mouseDragged=function(){return!1}}function A(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new Z(G):setTimeout(A,50)}document.addEventListener("DOMContentLoaded",A);let M=[];function T(t){const o=document.querySelector("#carousel");o&&(o.innerHTML="",t.forEach(a=>{const s=document.createElement("div");s.classList.add("slide");const e=document.createElement("div");if(e.classList.add("slide-inner"),a.image){const r=document.createElement("img");r.src=a.image,r.alt=a.title||"",e.appendChild(r)}const d=document.createElement("p");d.textContent=a.title||"",e.appendChild(d);const l=document.createElement("span");l.classList.add("tooltip"),l.title="[tap]",s.appendChild(e),s.appendChild(l),o.appendChild(s),s.addEventListener("click",()=>{S(s,a)})}))}document.addEventListener("DOMContentLoaded",()=>{fetch("/data/stone.json").then(o=>o.json()).then(o=>{M=o,T(M)}).catch(o=>console.error("Error loading stone data:",o)),document.querySelectorAll('#category-buttons button:not([data-category="filter"])').forEach(o=>{o.addEventListener("click",()=>{const a=o.dataset.category;if(a==="all")T(M);else{const s=M.filter(e=>e.category===a);T(s)}})})});document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector('#category-buttons button[data-category="filter"]'),o=document.querySelector("#category-buttons");!t||!o||t.addEventListener("click",()=>{o.classList.toggle("show-buttons")})});
