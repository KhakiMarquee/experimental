import{p as Z,_ as U}from"./ui-m0fsgGlm.js";import{openDetail as T}from"./openDetail-IY36Vf3N.js";const z=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(n=>n.json()).then(n=>{window.stoneData=n,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const f=document.querySelector("#carousel");if(!f){console.error("Carousel element not found");return}f.innerHTML="",n.forEach(c=>{const o=document.createElement("div");o.classList.add("slide");const t=document.createElement("div");t.classList.add("slide-inner");const d=document.createElement("img");d.src=c.image||"",d.alt=c.title||"";const i=document.createElement("p");i.textContent=c.title||"";const r=document.createElement("span");r.classList.add("tooltip"),r.title="[TAP]",t.appendChild(d),t.appendChild(i),o.appendChild(t),o.appendChild(r),f.appendChild(o),z()?G(o,c):o.addEventListener("click",()=>T(o,c))})}).catch(n=>{console.error("Error loading stone data:",n)})});function G(n,f){let o=0,t=0,d=!1;n.setAttribute("tabindex","0"),n.addEventListener("touchstart",i=>{const r=i.changedTouches[0];o=r.clientX,t=r.clientY,d=!1},{passive:!0}),n.addEventListener("touchmove",i=>{const r=i.touches[0];r&&Math.hypot(r.clientX-o,r.clientY-t)>8&&(d=!0)},{passive:!0}),n.addEventListener("touchend",()=>{d||T(n,f)}),n.addEventListener("focus",()=>{setTimeout(()=>{T(n,f)},150)})}function J(n){let f,c=[],o=0,t=0;const d=900;let i=!1;const r=100;let L=0,w=0,E=!1;const _=8;let D=0,S=0,y=!1,C=!1;n.setup=function(){n.noCanvas(),f=document.getElementById("carousel"),c=Array.from(document.querySelectorAll(".slide"));const e=document.getElementById("carousel-container");e.style.perspective="2000px",f.style.transformStyle="preserve-3d",A()?W():Y(),n.loop()},n.draw=function(){f.style.transform="rotateX(-15deg) rotateY(-30deg)";const a=c.length*d;o=(o+t)%a,o<0&&(o+=a);const u=o/a,l=document.querySelector(".progress-dot");l&&(l.style.backgroundColor=u>=.8?"var(--grey-800)":"rgba(var(--grey-100), 0.4)"),c.forEach((h,B)=>{let g=(B*d-o)%a;g<-d*2&&(g+=a);let x=g-a,b=g+a,p=g;const M=window.innerWidth/2;Math.abs(x-M)<Math.abs(p-M)&&(p=x),Math.abs(b-M)<Math.abs(p-M)&&(p=b);const F=p,H=p*-.5,R=-Math.abs(p)*.2;!h.classList.contains("expanding")&&!h.classList.contains("fullscreen")&&(h.style.transform=`
          translateX(${Math.round(F*100)/100}px)
          translateY(${Math.round(H*100)/100}px)
          translateZ(${Math.round(R*100)/100}px)
        `)});const m=Math.abs(t);let v;if(m>25)v=.88;else if(m>10){const h=(m-10)/15;v=.92+(.88-.92)*h*h*(3-2*h)}else if(m>2)v=.92;else if(m>.5){const h=(m-.5)/1.5;v=.94+(.92-.94)*h}else v=.94;t*=v,Math.abs(t)<.005&&(t=0)};function A(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function Y(){const e=document.getElementById("carousel-container");if(!e)return;e.addEventListener("wheel",O,{passive:!1}),e.addEventListener("mousedown",I),e.addEventListener("mouseup",q),e.addEventListener("mousemove",V);const s=document.querySelector("footer, .footer"),a=document.querySelector("header, .header, .site-header");[s,a].forEach(u=>{u&&(u.addEventListener("wheel",l=>{l.stopPropagation(),l.preventDefault()},{passive:!1}),u.addEventListener("mousedown",l=>l.stopPropagation()),u.addEventListener("mousemove",l=>l.stopPropagation()))}),n.mouseWheel=()=>!1,n.mousePressed=()=>!1,n.mouseReleased=()=>!1,n.mouseDragged=()=>!1}function O(e){e.preventDefault();let s=-e.deltaY/8;s=Math.max(-8,Math.min(8,s));const a=t+s;t+=(a-t)*.6,t=Math.max(-r*.8,Math.min(r*.8,t))}function I(e){e.preventDefault(),i=!0,w=e.clientX}function q(e){e.preventDefault(),i=!1}function V(e){if(!i)return;e.preventDefault();let s=e.clientX-w,a=Math.max(-15,Math.min(15,s*-1.2));t+=(a-t)*.7,t=Math.max(-r*.8,Math.min(r*.8,t)),w=e.clientX}function W(){const e=document.getElementById("carousel-container");e&&(e.addEventListener("touchstart",$,{passive:!1}),e.addEventListener("touchmove",j,{passive:!1}),e.addEventListener("touchend",k,{passive:!1}))}function $(e){e.target.closest("header, .header, .site-header, footer, .footer")||(i=!0,E=!0,y=!1,L=D=e.touches[0].clientX,S=e.touches[0].clientY,t=0,C=!0,setTimeout(()=>C=!1,400),e.preventDefault())}function j(e){if(!E||e.touches.length!==1)return;const s=e.touches[0].clientX,a=s-L;Math.hypot(s-D,e.touches[0].clientY-S)>_&&(y=!0);let u=Math.max(-50,Math.min(50,-a*1.5));t+=(u-t)*.7,L=s,e.preventDefault()}function k(e){if(E){if(!y){const s=e.target.closest(".slide");if(s)if(s.focus({preventScroll:!0}),s.classList.contains("fullscreen"))s.classList.remove("fullscreen");else{const a=[...c].indexOf(s),u=window.stoneData?.[a];u&&U(async()=>{const{openDetail:l}=await import("./openDetail-IY36Vf3N.js");return{openDetail:l}},[]).then(({openDetail:l})=>l(s,u))}}i=!1,E=!1}}const X=e=>{if(e.target.closest("header, .header, .site-header, footer, .footer"))return;const s=document.querySelector(".slide.fullscreen");s&&!e.target.closest(".slide.fullscreen")&&s.classList.remove("fullscreen")};document.addEventListener("touchstart",X,{passive:!0}),document.addEventListener("click",e=>{C||X(e)},{passive:!0})}function P(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new Z(J):setTimeout(P,50)}document.addEventListener("DOMContentLoaded",P);
