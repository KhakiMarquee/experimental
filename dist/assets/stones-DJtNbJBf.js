import{p as Q,_ as ee}from"./ui-BnT9v67C.js";function $(e,s){e.classList.add("expanding"),window.p5Instance&&window.p5Instance.noLoop();const r=e.getBoundingClientRect(),a=r.top+window.scrollY,n=r.left+window.scrollX,h=r.width,d=r.height;e.parentElement,e.nextSibling,e.style.transition="none",e.style.position="fixed",e.style.top=`${a}px`,e.style.left=`${n}px`,e.style.width=`${h}px`,e.style.height=`${d}px`,e.style.margin="0",e.style.transform="none",e.style.zIndex="10000",e.style.willChange="top,left,width,height,transform",document.body.appendChild(e),e.getBoundingClientRect();const c=600;e.style.transition=`top ${c}ms ease, left ${c}ms ease, width ${c}ms ease, height ${c}ms ease, transform ${c}ms ease`,e.style.top="0px",e.style.left="0px",e.style.width="100vw",e.style.height="100vh",e.classList.add("fullscreen");const m=x=>{x.target===e&&e.classList.contains("fullscreen")&&(e.removeEventListener("transitionend",m),e.style.willChange="",O(s))};e.addEventListener("transitionend",m),setTimeout(()=>{document.body.contains(e)&&O(s)},c+50)}function O(e){document.body.innerHTML=`
    <div id="detail-app" style="min-height:100vh; display:flex; flex-direction:column; padding:24px; box-sizing:border-box;">
      <button id="close-detail" aria-label="Close" style="align-self:flex-end; font-size:1.25rem; background:none; border:none; cursor:pointer;">âœ•</button>
      <main style="max-width:960px; width:100%; margin:0 auto;">
        <h1 style="margin:0 0 12px 0;">${e.title}</h1>
        <p style="margin:0 0 8px 0;"><strong>Material:</strong> ${e.material??""}</p>
        <p style="margin:0 0 16px 0;">${e.description??""}</p>
        ${e.image?`<img src="${e.image}" alt="${e.title}" style="max-width:100%; height:auto; display:block;">`:""}
      </main>
    </div>
  `,document.getElementById("close-detail").addEventListener("click",()=>{location.reload()})}const te=Object.freeze(Object.defineProperty({__proto__:null,openDetail:$},Symbol.toStringTag,{value:"Module"})),ne=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(e=>e.json()).then(e=>{window.stoneData=e,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const s=document.querySelector("#carousel");if(!s){console.error("Carousel element not found");return}s.innerHTML="",e.forEach(r=>{const a=document.createElement("div");a.classList.add("slide");const n=document.createElement("div");n.classList.add("slide-inner");const h=document.createElement("img");h.src=r.image||"",h.alt=r.title||"";const d=document.createElement("p");d.textContent=r.title||"";const c=document.createElement("span");c.classList.add("tooltip"),c.title="[TAP]",n.appendChild(h),n.appendChild(d),a.appendChild(n),a.appendChild(c),s.appendChild(a),ne()?setupSingleeTap(a,r):a.addEventListener("click",()=>$(a,r))})}).catch(e=>{console.error("Error loading stone data:",e)})});function oe(e){let s,r=[],a=0,n=0;const h=900;let d=!1;const c=100;let m=0;e.setup=function(){e.noCanvas(),s=document.getElementById("carousel"),r=Array.from(document.querySelectorAll(".slide"));const i=document.getElementById("carousel-container");i.style.perspective="2000px",s.style.transformStyle="preserve-3d",x()?H():q(),e.loop()},e.draw=function(){s.style.transform="rotateX(-15deg) rotateY(-30deg)";const o=r.length*h;a+=n,a=a%o,a<0&&(a+=o);const u=a/o,D=document.querySelector(".progress-dot");D&&(u>=.8?D.style.backgroundColor="var(--grey-800)":D.style.backgroundColor="rgba(var(--grey-100), 0.4)"),r.forEach((f,T)=>{let E=(T*h-a)%o;E<-h*2&&(E+=o);let _=E-o,A=E+o,p=E;const w=window.innerWidth/2;Math.abs(_-w)<Math.abs(p-w)&&(p=_),Math.abs(A-w)<Math.abs(p-w)&&(p=A);const F=p,N=p*-.5,U=-Math.abs(p)*.2,G=Math.round(F*100)/100,J=Math.round(N*100)/100,K=Math.round(U*100)/100;f.classList.contains("expanding")||f.classList.contains("fullscreen")||(f.style.transform=`
        translateX(${G}px)
        translateY(${J}px)
        translateZ(${K}px)
      `)});const g=Math.abs(n);let y;if(g>25)y=.88;else if(g>10){const f=(g-10)/15,T=f*f*(3-2*f);y=.92+(.88-.92)*T}else if(g>2)y=.92;else if(g>.5){const f=(g-.5)/1.5;y=.94+(.92-.94)*f}else y=.94;n*=y,Math.abs(n)<.005&&(n=0)};function x(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function q(){const t=document.querySelector("footer, .footer"),i=document.querySelector("header, .header, .site-header"),l=document.getElementById("carousel-container");l&&(l.addEventListener("mouseenter",()=>{d=!1}),l.addEventListener("mouseleave",()=>{d=!1,n*=.7}),l.addEventListener("wheel",R,{passive:!1}),l.addEventListener("mousedown",z),l.addEventListener("mouseup",V),l.addEventListener("mousemove",Z)),[t,i].forEach(o=>{o&&(o.addEventListener("wheel",u=>{u.stopPropagation(),u.preventDefault()},{passive:!1}),o.addEventListener("mousedown",u=>{u.stopPropagation()}),o.addEventListener("mousemove",u=>{u.stopPropagation()}))})}let v=!1,M=0;const Y=8;let P=0,I=0,b=!1,C=!1;function B(t){t.target.closest("header, .header, .site-header, footer, .footer")||(document.getElementById("carousel-container"),t.target.closest("#carousel-container")&&(d=!0,v=!0,M=0,m=t.touches[0].clientX,n=0,P=t.touches[0].clientX,I=t.touches[0].clientY,b=!1,C=!0,setTimeout(()=>C=!1,400)))}function j(t){if(!v||t.touches.length!==1)return;const i=t.touches[0].clientX,l=i-m;M+=Math.abs(l),Math.hypot(t.touches[0].clientX-P,t.touches[0].clientY-I)>Y&&(b=!0),M>5&&t.preventDefault();let o=l*-1.5;const u=50;o=Math.max(-u,Math.min(u,o)),n+=(o-n)*.7,m=i}function W(t){v&&(b||setTimeout(()=>{const i=t.target.closest(".slide");if(i)if(i.classList.contains("fullscreen"))i.classList.remove("fullscreen");else{const l=[...r].indexOf(i),o=window.stoneData?.[l];o&&ee(async()=>{const{openDetail:u}=await Promise.resolve().then(()=>te);return{openDetail:u}},void 0).then(({openDetail:u})=>{u(i,o)})}},20),d=!1,v=!1)}function H(){const t=document.getElementById("carousel-container");t&&(t.addEventListener("touchstart",B,{passive:!1}),t.addEventListener("touchmove",j,{passive:!1}),t.addEventListener("touchend",W,{passive:!0}));const i=l=>{const o=document.querySelector(".slide.fullscreen");o&&!l.target.closest(".slide.fullscreen")&&o.classList.remove("fullscreen")};document.addEventListener("touchstart",i,{passive:!0}),document.addEventListener("click",l=>{C||i(l)},{passive:!0})}let S=0;function R(t){t.preventDefault(),t.stopPropagation();let i=-t.deltaY/8;const l=8;i=Math.max(-l,Math.min(l,i));const o=n+i;n=n+(o-n)*.6,n=Math.max(-c*.8,Math.min(c*.8,n))}function z(t){t.preventDefault(),t.stopPropagation(),d=!0,S=t.clientX}function V(t){t.preventDefault(),t.stopPropagation(),d=!1}function Z(t){if(d){t.preventDefault(),t.stopPropagation();let l=(t.clientX-S)*-1.2;const o=15;l=Math.max(-o,Math.min(o,l)),n=n+(l-n)*.7,n=Math.max(-c*.8,Math.min(c*.8,n)),S=t.clientX}}e.mouseWheel=function(t){return!1},e.mousePressed=function(){return!1},e.mouseReleased=function(){return!1},e.mouseDragged=function(){return!1}}function k(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new Q(oe):setTimeout(k,50)}document.addEventListener("DOMContentLoaded",k);let L=[];function X(e){const s=document.querySelector("#carousel");s&&(s.innerHTML="",e.forEach(r=>{const a=document.createElement("div");a.classList.add("slide");const n=document.createElement("div");if(n.classList.add("slide-inner"),r.image){const c=document.createElement("img");c.src=r.image,c.alt=r.title||"",n.appendChild(c)}const h=document.createElement("p");h.textContent=r.title||"",n.appendChild(h);const d=document.createElement("span");d.classList.add("tooltip"),d.title="[tap]",a.appendChild(n),a.appendChild(d),s.appendChild(a),a.addEventListener("click",()=>{$(a,r)})}))}document.addEventListener("DOMContentLoaded",()=>{fetch("/data/stone.json").then(s=>s.json()).then(s=>{L=s,X(L)}).catch(s=>console.error("Error loading stone data:",s)),document.querySelectorAll('#category-buttons button:not([data-category="filter"])').forEach(s=>{s.addEventListener("click",()=>{const r=s.dataset.category;if(r==="all")X(L);else{const a=L.filter(n=>n.category===r);X(a)}})})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector('#category-buttons button[data-category="filter"]'),s=document.querySelector("#category-buttons");!e||!s||e.addEventListener("click",()=>{s.classList.toggle("show-buttons")})});
