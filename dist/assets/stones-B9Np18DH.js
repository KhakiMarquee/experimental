import{p as J,_ as K}from"./ui-BnT9v67C.js";function D(t,o){t.classList.add("expanding"),window.p5Instance&&window.p5Instance.noLoop();const r=t.getBoundingClientRect(),s=r.top+window.scrollY,e=r.left+window.scrollX,d=r.width,c=r.height;t.parentElement,t.nextSibling,t.style.transition="none",t.style.position="fixed",t.style.top=`${s}px`,t.style.left=`${e}px`,t.style.width=`${d}px`,t.style.height=`${c}px`,t.style.margin="0",t.style.transform="none",t.style.zIndex="10000",t.style.willChange="top,left,width,height,transform",document.body.appendChild(t),t.getBoundingClientRect();const i=600;t.style.transition=`top ${i}ms ease, left ${i}ms ease, width ${i}ms ease, height ${i}ms ease, transform ${i}ms ease`,t.style.top="0px",t.style.left="0px",t.style.width="100vw",t.style.height="100vh",t.classList.add("fullscreen");const p=f=>{f.target===t&&t.classList.contains("fullscreen")&&(t.removeEventListener("transitionend",p),t.style.willChange="",$(o))};t.addEventListener("transitionend",p),setTimeout(()=>{document.body.contains(t)&&$(o)},i+50)}function $(t){document.body.innerHTML=`
    <div id="detail-app" style="min-height:100vh; display:flex; flex-direction:column; padding:24px; box-sizing:border-box;">
      <button id="close-detail" aria-label="Close" style="align-self:flex-end; font-size:1.25rem; background:none; border:none; cursor:pointer;">âœ•</button>
      <main style="max-width:960px; width:100%; margin:0 auto;">
        <h1 style="margin:0 0 12px 0;">${t.title}</h1>
        <p style="margin:0 0 8px 0;"><strong>Material:</strong> ${t.material??""}</p>
        <p style="margin:0 0 16px 0;">${t.description??""}</p>
        ${t.image?`<img src="${t.image}" alt="${t.title}" style="max-width:100%; height:auto; display:block;">`:""}
      </main>
    </div>
  `,document.getElementById("close-detail").addEventListener("click",()=>{location.reload()})}const Q=Object.freeze(Object.defineProperty({__proto__:null,openDetail:D},Symbol.toStringTag,{value:"Module"})),tt=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(t=>t.json()).then(t=>{window.stoneData=t,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const o=document.querySelector("#carousel");if(!o){console.error("Carousel element not found");return}o.innerHTML="",t.forEach(r=>{const s=document.createElement("div");s.classList.add("slide");const e=document.createElement("div");e.classList.add("slide-inner");const d=document.createElement("img");d.src=r.image||"",d.alt=r.title||"";const c=document.createElement("p");c.textContent=r.title||"";const i=document.createElement("span");i.classList.add("tooltip"),i.title="[TAP]",e.appendChild(d),e.appendChild(c),s.appendChild(e),s.appendChild(i),o.appendChild(s),tt()?et(s,r):s.addEventListener("click",()=>D(s,r))})}).catch(t=>{console.error("Error loading stone data:",t)})});function et(t,o){let e=0,d=0,c=0,i=!1;t.addEventListener("touchstart",p=>{const f=p.changedTouches[0];d=f.clientX,c=f.clientY,i=!1},{passive:!0}),t.addEventListener("touchmove",p=>{const f=p.touches[0];f&&Math.hypot(f.clientX-d,f.clientY-c)>8&&(i=!0)},{passive:!0}),t.addEventListener("touchend",()=>{const p=Date.now(),f=p-e<300;!i&&f?(D(t,o),e=0):i?e=0:e=p})}function nt(t){let o,r=[],s=0,e=0;const d=900;let c=!1;const i=100;let p=0;t.setup=function(){t.noCanvas(),o=document.getElementById("carousel"),r=Array.from(document.querySelectorAll(".slide"));const u=document.getElementById("carousel-container");u.style.perspective="2000px",o.style.transformStyle="preserve-3d",f()?I():Y(),t.loop()},t.draw=function(){o.style.transform="rotateX(-15deg) rotateY(-30deg)";const a=r.length*d;s+=e,s=s%a,s<0&&(s+=a);const h=s/a,E=document.querySelector(".progress-dot");E&&(h>=.8?E.style.backgroundColor="var(--grey-800)":E.style.backgroundColor="rgba(var(--grey-100), 0.4)"),r.forEach((g,S)=>{let w=(S*d-s)%a;w<-d*2&&(w+=a);let P=w-a,A=w+a,y=w;const x=window.innerWidth/2;Math.abs(P-x)<Math.abs(y-x)&&(y=P),Math.abs(A-x)<Math.abs(y-x)&&(y=A);const z=y,H=y*-.5,Z=-Math.abs(y)*.2,F=Math.round(z*100)/100,N=Math.round(H*100)/100,G=Math.round(Z*100)/100;g.classList.contains("expanding")||g.classList.contains("fullscreen")||(g.style.transform=`
        translateX(${F}px)
        translateY(${N}px)
        translateZ(${G}px)
      `)});const m=Math.abs(e);let v;if(m>25)v=.88;else if(m>10){const g=(m-10)/15,S=g*g*(3-2*g);v=.92+(.88-.92)*S}else if(m>2)v=.92;else if(m>.5){const g=(m-.5)/1.5;v=.94+(.92-.94)*g}else v=.94;e*=v,Math.abs(e)<.005&&(e=0)};function f(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function Y(){const n=document.querySelector("footer, .footer"),u=document.querySelector("header, .header, .site-header"),l=document.getElementById("carousel-container");l&&(l.addEventListener("mouseenter",()=>{c=!1}),l.addEventListener("mouseleave",()=>{c=!1,e*=.7}),l.addEventListener("wheel",W,{passive:!1}),l.addEventListener("mousedown",R),l.addEventListener("mouseup",U),l.addEventListener("mousemove",V)),[n,u].forEach(a=>{a&&(a.addEventListener("wheel",h=>{h.stopPropagation(),h.preventDefault()},{passive:!1}),a.addEventListener("mousedown",h=>{h.stopPropagation()}),a.addEventListener("mousemove",h=>{h.stopPropagation()}))})}function I(){const n=document.getElementById("carousel-container");n&&(n.addEventListener("touchstart",k,{passive:!1}),n.addEventListener("touchmove",j,{passive:!1}),n.addEventListener("touchend",_),n.addEventListener("touchcancel",_))}let L=!1,C=0,M=0;const B=300,q=8;function k(n){n.touches.length===1&&(c=!0,L=!0,C=0,p=n.touches[0].clientX,e=0,startX=n.touches[0].clientX,startY=n.touches[0].clientY,moved=!1)}function j(n){if(!L||n.touches.length!==1)return;const u=n.touches[0].clientX,l=u-p;C+=Math.abs(l),Math.hypot(n.touches[0].clientX-startX,n.touches[0].clientY-startY)>q&&(moved=!0),C>5&&n.preventDefault();let a=l*-1.5;const h=50;a=Math.max(-h,Math.min(h,a)),e+=(a-e)*.7,p=u}function _(n){if(L){const u=Date.now(),l=u-M<B;if(!moved&&l){const a=n.target.closest(".slide");if(a){const h=[...document.querySelectorAll(".slide")].indexOf(a),E=window.stoneData?.[h];E&&K(async()=>{const{openDetail:m}=await Promise.resolve().then(()=>Q);return{openDetail:m}},void 0).then(({openDetail:m})=>{m(a,E)})}M=0}else moved?M=0:M=u;c=!1,L=!1}}let T=0;function W(n){n.preventDefault(),n.stopPropagation();let u=-n.deltaY/8;const l=8;u=Math.max(-l,Math.min(l,u));const a=e+u;e=e+(a-e)*.6,e=Math.max(-i*.8,Math.min(i*.8,e))}function R(n){n.preventDefault(),n.stopPropagation(),c=!0,T=n.clientX}function U(n){n.preventDefault(),n.stopPropagation(),c=!1}function V(n){if(c){n.preventDefault(),n.stopPropagation();let l=(n.clientX-T)*-1.2;const a=15;l=Math.max(-a,Math.min(a,l)),e=e+(l-e)*.7,e=Math.max(-i*.8,Math.min(i*.8,e)),T=n.clientX}}t.mouseWheel=function(n){return!1},t.mousePressed=function(){return!1},t.mouseReleased=function(){return!1},t.mouseDragged=function(){return!1}}function O(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new J(nt):setTimeout(O,50)}document.addEventListener("DOMContentLoaded",O);let b=[];function X(t){const o=document.querySelector("#carousel");o&&(o.innerHTML="",t.forEach(r=>{const s=document.createElement("div");s.classList.add("slide");const e=document.createElement("div");if(e.classList.add("slide-inner"),r.image){const i=document.createElement("img");i.src=r.image,i.alt=r.title||"",e.appendChild(i)}const d=document.createElement("p");d.textContent=r.title||"",e.appendChild(d);const c=document.createElement("span");c.classList.add("tooltip"),c.title="[tap]",s.appendChild(e),s.appendChild(c),o.appendChild(s),s.addEventListener("click",()=>{D(s,r)})}))}document.addEventListener("DOMContentLoaded",()=>{fetch("/data/stone.json").then(o=>o.json()).then(o=>{b=o,X(b)}).catch(o=>console.error("Error loading stone data:",o)),document.querySelectorAll('#category-buttons button:not([data-category="filter"])').forEach(o=>{o.addEventListener("click",()=>{const r=o.dataset.category;if(r==="all")X(b);else{const s=b.filter(e=>e.category===r);X(s)}})})});document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector('#category-buttons button[data-category="filter"]'),o=document.querySelector("#category-buttons");!t||!o||t.addEventListener("click",()=>{o.classList.toggle("show-buttons")})});
