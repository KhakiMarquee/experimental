import{p as ee,_ as te}from"./ui-Bx09MWB8.js";function $(e,s){e.classList.add("expanding"),window.p5Instance&&window.p5Instance.noLoop();const l=e.getBoundingClientRect(),a=l.top+window.scrollY,n=l.left+window.scrollX,f=l.width,d=l.height;e.parentElement,e.nextSibling,e.style.transition="none",e.style.position="fixed",e.style.top=`${a}px`,e.style.left=`${n}px`,e.style.width=`${f}px`,e.style.height=`${d}px`,e.style.margin="0",e.style.transform="none",e.style.zIndex="10000",e.style.willChange="top,left,width,height,transform",document.body.appendChild(e),e.getBoundingClientRect();const c=600;e.style.transition=`top ${c}ms ease, left ${c}ms ease, width ${c}ms ease, height ${c}ms ease, transform ${c}ms ease`,e.style.top="0px",e.style.left="0px",e.style.width="100vw",e.style.height="100vh",e.classList.add("fullscreen");const m=M=>{M.target===e&&e.classList.contains("fullscreen")&&(e.removeEventListener("transitionend",m),e.style.willChange="",A(s))};e.addEventListener("transitionend",m),setTimeout(()=>{document.body.contains(e)&&A(s)},c+50)}function A(e){document.body.innerHTML=`
    <div id="detail-app" style="min-height:100vh; display:flex; flex-direction:column; padding:24px; box-sizing:border-box;">
      <button id="close-detail" aria-label="Close" style="align-self:flex-end; font-size:1.25rem; background:none; border:none; cursor:pointer;">âœ•</button>
      <main style="max-width:960px; width:100%; margin:0 auto;">
        <h1 style="margin:0 0 12px 0;">${e.title}</h1>
        <p style="margin:0 0 8px 0;"><strong>Material:</strong> ${e.material??""}</p>
        <p style="margin:0 0 16px 0;">${e.description??""}</p>
        ${e.image?`<img src="${e.image}" alt="${e.title}" style="max-width:100%; height:auto; display:block;">`:""}
      </main>
    </div>
  `,document.getElementById("close-detail").addEventListener("click",()=>{location.reload()})}const ne=Object.freeze(Object.defineProperty({__proto__:null,openDetail:$},Symbol.toStringTag,{value:"Module"})),oe=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(e=>e.json()).then(e=>{window.stoneData=e,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const s=document.querySelector("#carousel");if(!s){console.error("Carousel element not found");return}s.innerHTML="",e.forEach(l=>{const a=document.createElement("div");a.classList.add("slide");const n=document.createElement("div");n.classList.add("slide-inner");const f=document.createElement("img");f.src=l.image||"",f.alt=l.title||"";const d=document.createElement("p");d.textContent=l.title||"";const c=document.createElement("span");c.classList.add("tooltip"),c.title="[TAP]",n.appendChild(f),n.appendChild(d),a.appendChild(n),a.appendChild(c),s.appendChild(a),oe()?setupSingleeTap(a,l):a.addEventListener("click",()=>$(a,l))})}).catch(e=>{console.error("Error loading stone data:",e)})});function se(e){let s,l=[],a=0,n=0;const f=900;let d=!1;const c=100;let m=0;e.setup=function(){e.noCanvas(),s=document.getElementById("carousel"),l=Array.from(document.querySelectorAll(".slide"));const r=document.getElementById("carousel-container");r.style.perspective="2000px",s.style.transformStyle="preserve-3d",M()?R():Y(),e.loop()},e.draw=function(){s.style.transform="rotateX(-15deg) rotateY(-30deg)";const o=l.length*f;a+=n,a=a%o,a<0&&(a+=o);const u=a/o,D=document.querySelector(".progress-dot");D&&(u>=.8?D.style.backgroundColor="var(--grey-800)":D.style.backgroundColor="rgba(var(--grey-100), 0.4)"),l.forEach((h,T)=>{let v=(T*f-a)%o;v<-f*2&&(v+=o);let k=v-o,q=v+o,p=v;const w=window.innerWidth/2;Math.abs(k-w)<Math.abs(p-w)&&(p=k),Math.abs(q-w)<Math.abs(p-w)&&(p=q);const N=p,U=p*-.5,G=-Math.abs(p)*.2,J=Math.round(N*100)/100,K=Math.round(U*100)/100,Q=Math.round(G*100)/100;h.classList.contains("expanding")||h.classList.contains("fullscreen")||(h.style.transform=`
        translateX(${J}px)
        translateY(${K}px)
        translateZ(${Q}px)
      `)});const g=Math.abs(n);let y;if(g>25)y=.88;else if(g>10){const h=(g-10)/15,T=h*h*(3-2*h);y=.92+(.88-.92)*T}else if(g>2)y=.92;else if(g>.5){const h=(g-.5)/1.5;y=.94+(.92-.94)*h}else y=.94;n*=y,Math.abs(n)<.005&&(n=0)};function M(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function Y(){const t=document.querySelector("footer, .footer"),r=document.querySelector("header, .header, .site-header"),i=document.getElementById("carousel-container");i&&(i.addEventListener("mouseenter",()=>{d=!1}),i.addEventListener("mouseleave",()=>{d=!1,n*=.7}),i.addEventListener("wheel",z,{passive:!1}),i.addEventListener("mousedown",V),i.addEventListener("mouseup",Z),i.addEventListener("mousemove",F)),[t,r].forEach(o=>{o&&(o.addEventListener("wheel",u=>{u.stopPropagation(),u.preventDefault()},{passive:!1}),o.addEventListener("mousedown",u=>{u.stopPropagation()}),o.addEventListener("mousemove",u=>{u.stopPropagation()}))})}let E=!1,C=0;const B=8;let P=0,I=0,b=!1,L=!1;function j(t){if(t.target.closest("header, .header, .site-header, footer, .footer"))return;document.getElementById("carousel-container")&&t.target.closest("#carousel-container")&&(d=!0,E=!0,C=0,m=t.touches[0].clientX,n=0,P=t.touches[0].clientX,I=t.touches[0].clientY,b=!1,L=!0,setTimeout(()=>L=!1,400))}const _=t=>{if(t.target.closest("header, .header, .site-header, footer, .footer"))return;const r=document.querySelector(".slide.fullscreen");r&&!t.target.closest(".slide.fullscreen")&&r.classList.remove("fullscreen")};document.addEventListener("touchstart",_,{passive:!0}),document.addEventListener("click",t=>{L||_(t)},{passive:!0});function W(t){if(!E||t.touches.length!==1)return;const r=t.touches[0].clientX,i=r-m;C+=Math.abs(i),Math.hypot(t.touches[0].clientX-P,t.touches[0].clientY-I)>B&&(b=!0),C>5&&t.preventDefault();let o=i*-1.5;const u=50;o=Math.max(-u,Math.min(u,o)),n+=(o-n)*.7,m=r}function H(t){E&&(b||setTimeout(()=>{const r=t.target.closest(".slide");if(r)if(r.classList.contains("fullscreen"))r.classList.remove("fullscreen");else{const i=[...l].indexOf(r),o=window.stoneData?.[i];o&&te(async()=>{const{openDetail:u}=await Promise.resolve().then(()=>ne);return{openDetail:u}},void 0).then(({openDetail:u})=>{u(r,o)})}},20),d=!1,E=!1)}function R(){const t=document.getElementById("carousel-container");t&&(t.addEventListener("touchstart",j,{passive:!1}),t.addEventListener("touchmove",W,{passive:!1}),t.addEventListener("touchend",H,{passive:!0}));const r=i=>{const o=document.querySelector(".slide.fullscreen");o&&!i.target.closest(".slide.fullscreen")&&o.classList.remove("fullscreen")};document.addEventListener("touchstart",r,{passive:!0}),document.addEventListener("click",i=>{L||r(i)},{passive:!0})}let S=0;function z(t){t.preventDefault(),t.stopPropagation();let r=-t.deltaY/8;const i=8;r=Math.max(-i,Math.min(i,r));const o=n+r;n=n+(o-n)*.6,n=Math.max(-c*.8,Math.min(c*.8,n))}function V(t){t.preventDefault(),t.stopPropagation(),d=!0,S=t.clientX}function Z(t){t.preventDefault(),t.stopPropagation(),d=!1}function F(t){if(d){t.preventDefault(),t.stopPropagation();let i=(t.clientX-S)*-1.2;const o=15;i=Math.max(-o,Math.min(o,i)),n=n+(i-n)*.7,n=Math.max(-c*.8,Math.min(c*.8,n)),S=t.clientX}}e.mouseWheel=function(t){return!1},e.mousePressed=function(){return!1},e.mouseReleased=function(){return!1},e.mouseDragged=function(){return!1}}function O(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new ee(se):setTimeout(O,50)}document.addEventListener("DOMContentLoaded",O);let x=[];function X(e){const s=document.querySelector("#carousel");s&&(s.innerHTML="",e.forEach(l=>{const a=document.createElement("div");a.classList.add("slide");const n=document.createElement("div");if(n.classList.add("slide-inner"),l.image){const c=document.createElement("img");c.src=l.image,c.alt=l.title||"",n.appendChild(c)}const f=document.createElement("p");f.textContent=l.title||"",n.appendChild(f);const d=document.createElement("span");d.classList.add("tooltip"),d.title="[tap]",a.appendChild(n),a.appendChild(d),s.appendChild(a),a.addEventListener("click",()=>{$(a,l)})}))}document.addEventListener("DOMContentLoaded",()=>{fetch("/data/stone.json").then(s=>s.json()).then(s=>{x=s,X(x)}).catch(s=>console.error("Error loading stone data:",s)),document.querySelectorAll('#category-buttons button:not([data-category="filter"])').forEach(s=>{s.addEventListener("click",()=>{const l=s.dataset.category;if(l==="all")X(x);else{const a=x.filter(n=>n.category===l);X(a)}})})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector('#category-buttons button[data-category="filter"]'),s=document.querySelector("#category-buttons");!e||!s||e.addEventListener("click",()=>{s.classList.toggle("show-buttons")})});
