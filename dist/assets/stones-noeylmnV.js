import{p as V}from"./ui-CTue3Ljv.js";function P(e,o){e.classList.add("expanding"),window.p5Instance&&window.p5Instance.noLoop();const s=e.getBoundingClientRect(),a=s.top+window.scrollY,t=s.left+window.scrollX,d=s.width,c=s.height;e.parentElement,e.nextSibling,e.style.transition="none",e.style.position="fixed",e.style.top=`${a}px`,e.style.left=`${t}px`,e.style.width=`${d}px`,e.style.height=`${c}px`,e.style.margin="0",e.style.transform="none",e.style.zIndex="10000",e.style.willChange="top,left,width,height,transform",document.body.appendChild(e),e.getBoundingClientRect();const i=600;e.style.transition=`top ${i}ms ease, left ${i}ms ease, width ${i}ms ease, height ${i}ms ease, transform ${i}ms ease`,e.style.top="0px",e.style.left="0px",e.style.width="100vw",e.style.height="100vh",e.classList.add("fullscreen");const g=x=>{x.target===e&&e.classList.contains("fullscreen")&&(e.removeEventListener("transitionend",g),e.style.willChange="",I(o))};e.addEventListener("transitionend",g),setTimeout(()=>{document.body.contains(e)&&I(o)},i+50)}function I(e){document.body.innerHTML=`
    <div id="detail-app" style="min-height:100vh; display:flex; flex-direction:column; padding:24px; box-sizing:border-box;">
      <button id="close-detail" aria-label="Close" style="align-self:flex-end; font-size:1.25rem; background:none; border:none; cursor:pointer;">âœ•</button>
      <main style="max-width:960px; width:100%; margin:0 auto;">
        <h1 style="margin:0 0 12px 0;">${e.title}</h1>
        <p style="margin:0 0 8px 0;"><strong>Material:</strong> ${e.material??""}</p>
        <p style="margin:0 0 16px 0;">${e.description??""}</p>
        ${e.image?`<img src="${e.image}" alt="${e.title}" style="max-width:100%; height:auto; display:block;">`:""}
      </main>
    </div>
  `,document.getElementById("close-detail").addEventListener("click",()=>{location.reload()})}const _=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(e=>e.json()).then(e=>{window.stoneData=e,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const o=document.querySelector("#carousel");if(!o){console.error("Carousel element not found");return}o.innerHTML="",e.forEach(s=>{const a=document.createElement("div");a.classList.add("slide");const t=document.createElement("div");t.classList.add("slide-inner");const d=document.createElement("img");d.src=s.image||"",d.alt=s.title||"";const c=document.createElement("p");c.textContent=s.title||"";const i=document.createElement("span");i.classList.add("tooltip"),i.title="[TAP]",t.appendChild(d),t.appendChild(c),a.appendChild(t),a.appendChild(i),o.appendChild(a),_()?setupSingleeTap(a,s):a.addEventListener("click",()=>P(a,s))})}).catch(e=>{console.error("Error loading stone data:",e)})});function G(e){let o,s=[],a=0,t=0;const d=900;let c=!1;const i=100;let g=0;e.setup=function(){e.noCanvas(),o=document.getElementById("carousel"),s=Array.from(document.querySelectorAll(".slide"));const u=document.getElementById("carousel-container");u.style.perspective="2000px",o.style.transformStyle="preserve-3d",x()?A():q(),e.loop()},e.draw=function(){o.style.transform="rotateX(-15deg) rotateY(-30deg)";const r=s.length*d;a+=t,a=a%r,a<0&&(a+=r);const h=a/r,C=document.querySelector(".progress-dot");C&&(h>=.8?C.style.backgroundColor="var(--grey-800)":C.style.backgroundColor="rgba(var(--grey-100), 0.4)"),s.forEach((p,S)=>{let w=(S*d-a)%r;w<-d*2&&(w+=r);let T=w-r,X=w+r,f=w;const v=window.innerWidth/2;Math.abs(T-v)<Math.abs(f-v)&&(f=T),Math.abs(X-v)<Math.abs(f-v)&&(f=X);const R=f,z=f*-.5,Z=-Math.abs(f)*.2,F=Math.round(R*100)/100,N=Math.round(z*100)/100,U=Math.round(Z*100)/100;p.classList.contains("expanding")||p.classList.contains("fullscreen")||(p.style.transform=`
        translateX(${F}px)
        translateY(${N}px)
        translateZ(${U}px)
      `)});const m=Math.abs(t);let y;if(m>25)y=.88;else if(m>10){const p=(m-10)/15,S=p*p*(3-2*p);y=.92+(.88-.92)*S}else if(m>2)y=.92;else if(m>.5){const p=(m-.5)/1.5;y=.94+(.92-.94)*p}else y=.94;t*=y,Math.abs(t)<.005&&(t=0)};function x(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function q(){const n=document.querySelector("footer, .footer"),u=document.querySelector("header, .header, .site-header"),l=document.getElementById("carousel-container");l&&(l.addEventListener("mouseenter",()=>{c=!1}),l.addEventListener("mouseleave",()=>{c=!1,t*=.7}),l.addEventListener("wheel",W,{passive:!1}),l.addEventListener("mousedown",O),l.addEventListener("mouseup",j),l.addEventListener("mousemove",H)),[n,u].forEach(r=>{r&&(r.addEventListener("wheel",h=>{h.stopPropagation(),h.preventDefault()},{passive:!1}),r.addEventListener("mousedown",h=>{h.stopPropagation()}),r.addEventListener("mousemove",h=>{h.stopPropagation()}))})}function A(){const n=document.getElementById("carousel-container");n&&(n.addEventListener("touchstart",B,{passive:!1}),n.addEventListener("touchmove",Y,{passive:!1}),n.addEventListener("touchend",$),n.addEventListener("touchcancel",$))}let E=!1,M=0;function B(n){n.touches.length===1&&(c=!0,E=!0,M=0,g=n.touches[0].clientX,t=0)}function Y(n){if(!E||n.touches.length!==1)return;const u=n.touches[0].clientX,l=u-g;M+=Math.abs(l),M>5&&n.preventDefault();let r=l*-1.5;const h=50;r=Math.max(-h,Math.min(h,r)),t+=(r-t)*.7,g=u}function $(n){E&&(c=!1,E=!1)}let b=0;function W(n){n.preventDefault(),n.stopPropagation();let u=-n.deltaY/8;const l=8;u=Math.max(-l,Math.min(l,u));const r=t+u;t=t+(r-t)*.6,t=Math.max(-i*.8,Math.min(i*.8,t))}function O(n){n.preventDefault(),n.stopPropagation(),c=!0,b=n.clientX}function j(n){n.preventDefault(),n.stopPropagation(),c=!1}function H(n){if(c){n.preventDefault(),n.stopPropagation();let l=(n.clientX-b)*-1.2;const r=15;l=Math.max(-r,Math.min(r,l)),t=t+(l-t)*.7,t=Math.max(-i*.8,Math.min(i*.8,t)),b=n.clientX}}e.mouseWheel=function(n){return!1},e.mousePressed=function(){return!1},e.mouseReleased=function(){return!1},e.mouseDragged=function(){return!1}}function k(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new V(G):setTimeout(k,50)}document.addEventListener("DOMContentLoaded",k);let L=[];function D(e){const o=document.querySelector("#carousel");o&&(o.innerHTML="",e.forEach(s=>{const a=document.createElement("div");a.classList.add("slide");const t=document.createElement("div");if(t.classList.add("slide-inner"),s.image){const i=document.createElement("img");i.src=s.image,i.alt=s.title||"",t.appendChild(i)}const d=document.createElement("p");d.textContent=s.title||"",t.appendChild(d);const c=document.createElement("span");c.classList.add("tooltip"),c.title="[tap]",a.appendChild(t),a.appendChild(c),o.appendChild(a),a.addEventListener("click",()=>{P(a,s)})}))}document.addEventListener("DOMContentLoaded",()=>{fetch("/data/stone.json").then(o=>o.json()).then(o=>{L=o,D(L)}).catch(o=>console.error("Error loading stone data:",o)),document.querySelectorAll('#category-buttons button:not([data-category="filter"])').forEach(o=>{o.addEventListener("click",()=>{const s=o.dataset.category;if(s==="all")D(L);else{const a=L.filter(t=>t.category===s);D(a)}})})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector('#category-buttons button[data-category="filter"]'),o=document.querySelector("#category-buttons");!e||!o||e.addEventListener("click",()=>{o.classList.toggle("show-buttons")})});
