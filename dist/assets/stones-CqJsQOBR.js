import{p as Z,_ as G}from"./ui-Bx09MWB8.js";function x(e,o){e.classList.add("expanding"),window.p5Instance&&window.p5Instance.noLoop();const r=e.getBoundingClientRect(),s=r.top+window.scrollY,n=r.left+window.scrollX,d=r.width,i=r.height;e.parentElement,e.nextSibling,e.style.transition="none",e.style.position="fixed",e.style.top=`${s}px`,e.style.left=`${n}px`,e.style.width=`${d}px`,e.style.height=`${i}px`,e.style.margin="0",e.style.transform="none",e.style.zIndex="10000",e.style.willChange="top,left,width,height,transform",document.body.appendChild(e),e.getBoundingClientRect();const a=600;e.style.transition=`top ${a}ms ease, left ${a}ms ease, width ${a}ms ease, height ${a}ms ease, transform ${a}ms ease`,e.style.top="0px",e.style.left="0px",e.style.width="100vw",e.style.height="100vh",e.classList.add("fullscreen");const m=v=>{v.target===e&&e.classList.contains("fullscreen")&&(e.removeEventListener("transitionend",m),e.style.willChange="",O(o))};e.addEventListener("transitionend",m),setTimeout(()=>{document.body.contains(e)&&O(o)},a+50)}function O(e){document.body.innerHTML=`
    <div id="detail-app" style="min-height:100vh; display:flex; flex-direction:column; padding:24px; box-sizing:border-box;">
      <button id="close-detail" aria-label="Close" style="align-self:flex-end; font-size:1.25rem; background:none; border:none; cursor:pointer;">âœ•</button>
      <main style="max-width:960px; width:100%; margin:0 auto;">
        <h1 style="margin:0 0 12px 0;">${e.title}</h1>
        <p style="margin:0 0 8px 0;"><strong>Material:</strong> ${e.material??""}</p>
        <p style="margin:0 0 16px 0;">${e.description??""}</p>
        ${e.image?`<img src="${e.image}" alt="${e.title}" style="max-width:100%; height:auto; display:block;">`:""}
      </main>
    </div>
  `,document.getElementById("close-detail").addEventListener("click",()=>{location.reload()})}const J=Object.freeze(Object.defineProperty({__proto__:null,openDetail:x},Symbol.toStringTag,{value:"Module"})),K=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(e=>e.json()).then(e=>{window.stoneData=e,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const o=document.querySelector("#carousel");if(!o){console.error("Carousel element not found");return}o.innerHTML="",e.forEach(r=>{const s=document.createElement("div");s.classList.add("slide");const n=document.createElement("div");n.classList.add("slide-inner");const d=document.createElement("img");d.src=r.image||"",d.alt=r.title||"";const i=document.createElement("p");i.textContent=r.title||"";const a=document.createElement("span");a.classList.add("tooltip"),a.title="[TAP]",n.appendChild(d),n.appendChild(i),s.appendChild(n),s.appendChild(a),o.appendChild(s),K()?Q(s,r):s.addEventListener("click",()=>x(s,r))})}).catch(e=>{console.error("Error loading stone data:",e)})});function Q(e,o){let s=0,n=0,d=!1;e.addEventListener("touchstart",i=>{const a=i.changedTouches[0];s=a.clientX,n=a.clientY,d=!1},{passive:!0}),e.addEventListener("touchmove",i=>{const a=i.touches[0];a&&Math.hypot(a.clientX-s,a.clientY-n)>8&&(d=!0)},{passive:!0}),e.addEventListener("touchend",()=>{d||x(e,o)})}function ee(e){let o,r=[],s=0,n=0;const d=900;let i=!1;const a=100;let m=0,v=0,L=!1;const A=8;let T=0,D=0,b=!1,C=!1;e.setup=function(){e.noCanvas(),o=document.getElementById("carousel"),r=Array.from(document.querySelectorAll(".slide"));const t=document.getElementById("carousel-container");t.style.perspective="2000px",o.style.transformStyle="preserve-3d",I()?W():Y(),e.loop()},e.draw=function(){o.style.transform="rotateX(-15deg) rotateY(-30deg)";const c=r.length*d;s=(s+n)%c,s<0&&(s+=c);const f=s/c,u=document.querySelector(".progress-dot");u&&(u.style.backgroundColor=f>=.8?"var(--grey-800)":"rgba(var(--grey-100), 0.4)"),r.forEach((h,z)=>{let E=(z*d-s)%c;E<-d*2&&(E+=c);let X=E-c,_=E+c,p=E;const w=window.innerWidth/2;Math.abs(X-w)<Math.abs(p-w)&&(p=X),Math.abs(_-w)<Math.abs(p-w)&&(p=_);const F=p,N=p*-.5,U=-Math.abs(p)*.2;!h.classList.contains("expanding")&&!h.classList.contains("fullscreen")&&(h.style.transform=`
          translateX(${Math.round(F*100)/100}px)
          translateY(${Math.round(N*100)/100}px)
          translateZ(${Math.round(U*100)/100}px)
        `)});const g=Math.abs(n);let y;if(g>25)y=.88;else if(g>10){const h=(g-10)/15;y=.92+(.88-.92)*h*h*(3-2*h)}else if(g>2)y=.92;else if(g>.5){const h=(g-.5)/1.5;y=.94+(.92-.94)*h}else y=.94;n*=y,Math.abs(n)<.005&&(n=0)};function I(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function Y(){const t=document.getElementById("carousel-container");if(!t)return;t.addEventListener("wheel",q,{passive:!1}),t.addEventListener("mousedown",k),t.addEventListener("mouseup",B),t.addEventListener("mousemove",j);const l=document.querySelector("footer, .footer"),c=document.querySelector("header, .header, .site-header");[l,c].forEach(f=>{f&&(f.addEventListener("wheel",u=>{u.stopPropagation(),u.preventDefault()},{passive:!1}),f.addEventListener("mousedown",u=>u.stopPropagation()),f.addEventListener("mousemove",u=>u.stopPropagation()))}),e.mouseWheel=()=>!1,e.mousePressed=()=>!1,e.mouseReleased=()=>!1,e.mouseDragged=()=>!1}function q(t){t.preventDefault();let l=-t.deltaY/8;l=Math.max(-8,Math.min(8,l));const c=n+l;n+=(c-n)*.6,n=Math.max(-a*.8,Math.min(a*.8,n))}function k(t){t.preventDefault(),i=!0,v=t.clientX}function B(t){t.preventDefault(),i=!1}function j(t){if(!i)return;t.preventDefault();let l=t.clientX-v,c=Math.max(-15,Math.min(15,l*-1.2));n+=(c-n)*.7,n=Math.max(-a*.8,Math.min(a*.8,n)),v=t.clientX}function W(){const t=document.getElementById("carousel-container");t&&(t.addEventListener("touchstart",H,{passive:!1}),t.addEventListener("touchmove",R,{passive:!1}),t.addEventListener("touchend",V,{passive:!1}))}function H(t){t.target.closest("header, .header, .site-header, footer, .footer")||(i=!0,L=!0,b=!1,m=T=t.touches[0].clientX,D=t.touches[0].clientY,n=0,C=!0,setTimeout(()=>C=!1,400),t.preventDefault())}function R(t){if(!L||t.touches.length!==1)return;const l=t.touches[0].clientX,c=l-m;Math.hypot(l-T,t.touches[0].clientY-D)>A&&(b=!0);let f=Math.max(-50,Math.min(50,-c*1.5));n+=(f-n)*.7,m=l,t.preventDefault()}function V(t){if(L){if(!b){const l=t.target.closest(".slide");if(l)if(l.classList.contains("fullscreen"))l.classList.remove("fullscreen");else{const c=[...r].indexOf(l),f=window.stoneData?.[c];f&&G(async()=>{const{openDetail:u}=await Promise.resolve().then(()=>J);return{openDetail:u}},void 0).then(({openDetail:u})=>u(l,f))}}i=!1,L=!1}}const $=t=>{if(t.target.closest("header, .header, .site-header, footer, .footer"))return;const l=document.querySelector(".slide.fullscreen");l&&!t.target.closest(".slide.fullscreen")&&l.classList.remove("fullscreen")};document.addEventListener("touchstart",$,{passive:!0}),document.addEventListener("click",t=>{C||$(t)},{passive:!0})}function P(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new Z(ee):setTimeout(P,50)}document.addEventListener("DOMContentLoaded",P);let M=[];function S(e){const o=document.querySelector("#carousel");o&&(o.innerHTML="",e.forEach(r=>{const s=document.createElement("div");s.classList.add("slide");const n=document.createElement("div");if(n.classList.add("slide-inner"),r.image){const a=document.createElement("img");a.src=r.image,a.alt=r.title||"",n.appendChild(a)}const d=document.createElement("p");d.textContent=r.title||"",n.appendChild(d);const i=document.createElement("span");i.classList.add("tooltip"),i.title="[tap]",s.appendChild(n),s.appendChild(i),o.appendChild(s),s.addEventListener("click",()=>{x(s,r)})}))}document.addEventListener("DOMContentLoaded",()=>{fetch("/data/stone.json").then(o=>o.json()).then(o=>{M=o,S(M)}).catch(o=>console.error("Error loading stone data:",o)),document.querySelectorAll('#category-buttons button:not([data-category="filter"])').forEach(o=>{o.addEventListener("click",()=>{const r=o.dataset.category;if(r==="all")S(M);else{const s=M.filter(n=>n.category===r);S(s)}})})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector('#category-buttons button[data-category="filter"]'),o=document.querySelector("#category-buttons");!e||!o||e.addEventListener("click",()=>{o.classList.toggle("show-buttons")})});
