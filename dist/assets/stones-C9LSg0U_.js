import{p as Z,_ as N}from"./category-Cd6EpTbZ.js";import{openDetail as T}from"./openDetail-GWXhpPhG.js";const U=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(n=>n.json()).then(n=>{window.stoneData=n,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length),document.querySelectorAll(".catNum").forEach(s=>{const t=s.innerText.trim().toLowerCase();if(t==="all")s.title=n.length;else{const l=n.filter(r=>r.type?.toLowerCase()===t).length;s.title=l,console.log(t,"->",s.title)}});const u=document.querySelector("#carousel");if(!u){console.error("Carousel element not found");return}u.innerHTML="",n.forEach(s=>{const t=document.createElement("div");t.classList.add("slide");const l=document.createElement("div");l.classList.add("slide-inner");const r=document.createElement("img");r.src=s.image||"",r.alt=s.title||"";const i=document.createElement("p");i.textContent=s.title||"";const m=document.createElement("span");m.classList.add("tooltip"),m.title="[TAP]",l.appendChild(r),l.appendChild(i),t.appendChild(l),t.appendChild(m),u.appendChild(t),U()?z(t,s):t.addEventListener("click",()=>T(t,s))})}).catch(n=>{console.error("Error loading stone data:",n)})});function z(n,h){let s=0,t=0,l=!1;n.setAttribute("tabindex","0"),n.addEventListener("touchstart",r=>{const i=r.changedTouches[0];s=i.clientX,t=i.clientY,l=!1},{passive:!0}),n.addEventListener("touchmove",r=>{const i=r.touches[0];i&&Math.hypot(i.clientX-s,i.clientY-t)>8&&(l=!0)},{passive:!0}),n.addEventListener("touchend",()=>{l||T(n,h)}),n.addEventListener("focus",()=>{setTimeout(()=>{T(n,h)},150)})}function G(n){let h,u=[],s=0,t=0;const l=900;let r=!1;const i=100;let m=0,L=0,E=!1;const P=8;let C=0,b=0,y=!1,S=!1;n.setup=function(){n.noCanvas(),h=document.getElementById("carousel"),u=Array.from(document.querySelectorAll(".slide"));const e=document.getElementById("carousel-container");e.style.perspective="2000px",h.style.transformStyle="preserve-3d",window.isMobile=()=>("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768,new MutationObserver(()=>n.refreshSlides&&n.refreshSlides()).observe(h,{childList:!0}),_()?V():O(),n.loop()},n.refreshSlides=function(){u=Array.from(document.querySelectorAll(".slide"))},n.draw=function(){h.style.transform="rotateX(-15deg) rotateY(-30deg)";const a=u.length*l;s=(s+t)%a,s<0&&(s+=a);const d=s/a,c=document.querySelector(".progress-dot");c&&(c.style.backgroundColor=d>=.8?"var(--grey-800)":"rgba(var(--grey-100), 0.4)"),u.forEach((f,B)=>{let w=(B*l-s)%a;w<-l*2&&(w+=a);let D=w-a,X=w+a,p=w;const M=window.innerWidth/2;Math.abs(D-M)<Math.abs(p-M)&&(p=D),Math.abs(X-M)<Math.abs(p-M)&&(p=X);const F=p,H=p*-.5,R=-Math.abs(p)*.2;!f.classList.contains("expanding")&&!f.classList.contains("fullscreen")&&(f.style.transform=`
          translateX(${Math.round(F*100)/100}px)
          translateY(${Math.round(H*100)/100}px)
          translateZ(${Math.round(R*100)/100}px)
        `)});const v=Math.abs(t);let g;if(v>25)g=.88;else if(v>10){const f=(v-10)/15;g=.92+(.88-.92)*f*f*(3-2*f)}else if(v>2)g=.92;else if(v>.5){const f=(v-.5)/1.5;g=.94+(.92-.94)*f}else g=.94;t*=g,Math.abs(t)<.005&&(t=0)};function _(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function O(){const e=document.getElementById("carousel-container");if(!e)return;e.addEventListener("wheel",Y,{passive:!1}),e.addEventListener("mousedown",q),e.addEventListener("mouseup",I),e.addEventListener("mousemove",W);const o=document.querySelector("footer, .footer"),a=document.querySelector("header, .header, .site-header");[o,a].forEach(d=>{d&&(d.addEventListener("wheel",c=>{c.stopPropagation(),c.preventDefault()},{passive:!1}),d.addEventListener("mousedown",c=>c.stopPropagation()),d.addEventListener("mousemove",c=>c.stopPropagation()))}),n.mouseWheel=()=>!1,n.mousePressed=()=>!1,n.mouseReleased=()=>!1,n.mouseDragged=()=>!1}function Y(e){e.preventDefault();let o=-e.deltaY/8;o=Math.max(-8,Math.min(8,o));const a=t+o;t+=(a-t)*.6,t=Math.max(-i*.8,Math.min(i*.8,t))}function q(e){e.preventDefault(),r=!0,L=e.clientX}function I(e){e.preventDefault(),r=!1}function W(e){if(!r)return;e.preventDefault();let o=e.clientX-L,a=Math.max(-15,Math.min(15,o*-1.2));t+=(a-t)*.7,t=Math.max(-i*.8,Math.min(i*.8,t)),L=e.clientX}function V(){const e=document.getElementById("carousel-container");e&&(e.addEventListener("touchstart",$,{passive:!1}),e.addEventListener("touchmove",j,{passive:!1}),e.addEventListener("touchend",k,{passive:!1}))}function $(e){e.target.closest("header, .header, .site-header, footer, .footer")||(r=!0,E=!0,y=!1,m=C=e.touches[0].clientX,b=e.touches[0].clientY,t=0,S=!0,setTimeout(()=>S=!1,400),e.preventDefault())}function j(e){if(!E||e.touches.length!==1)return;const o=e.touches[0].clientX,a=o-m;Math.hypot(o-C,e.touches[0].clientY-b)>P&&(y=!0);let d=Math.max(-50,Math.min(50,-a*1.5));t+=(d-t)*.7,m=o,e.preventDefault()}function k(e){if(E){if(!y){const o=e.target.closest(".slide");if(o)if(o.focus({preventScroll:!0}),o.classList.contains("fullscreen"))o.classList.remove("fullscreen");else{const a=[...u].indexOf(o),d=window.stoneData?.[a];d&&N(async()=>{const{openDetail:c}=await import("./openDetail-GWXhpPhG.js");return{openDetail:c}},[]).then(({openDetail:c})=>c(o,d))}}r=!1,E=!1}}const x=e=>{if(e.target.closest("header, .header, .site-header, footer, .footer"))return;const o=document.querySelector(".slide.fullscreen");o&&!e.target.closest(".slide.fullscreen")&&o.classList.remove("fullscreen")};document.addEventListener("touchstart",x,{passive:!0}),document.addEventListener("click",e=>{S||x(e)},{passive:!0})}function A(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new Z(G):setTimeout(A,50)}document.addEventListener("DOMContentLoaded",A);
