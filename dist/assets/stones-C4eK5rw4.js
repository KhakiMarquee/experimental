import{p as Z,_ as U}from"./ui-BU3SlZfe.js";import{openDetail as T}from"./openDetail-GWXhpPhG.js";import"./category-BeiuRnv8.js";const z=()=>("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=768;document.addEventListener("DOMContentLoaded",()=>{console.log("Fetching:","data/stone.json"),fetch("/data/stone.json").then(t=>t.json()).then(t=>{window.stoneData=t,console.log("[stoneData] loaded",Array.isArray(window.stoneData),window.stoneData?.length);const d=document.querySelector("#carousel");if(!d){console.error("Carousel element not found");return}d.innerHTML="",t.forEach(l=>{const s=document.createElement("div");s.classList.add("slide");const n=document.createElement("div");n.classList.add("slide-inner");const u=document.createElement("img");u.src=l.image||"",u.alt=l.title||"";const c=document.createElement("p");c.textContent=l.title||"";const r=document.createElement("span");r.classList.add("tooltip"),r.title="[TAP]",n.appendChild(u),n.appendChild(c),s.appendChild(n),s.appendChild(r),d.appendChild(s),z()?G(s,l):s.addEventListener("click",()=>T(s,l))})}).catch(t=>{console.error("Error loading stone data:",t)})});function G(t,d){let s=0,n=0,u=!1;t.setAttribute("tabindex","0"),t.addEventListener("touchstart",c=>{const r=c.changedTouches[0];s=r.clientX,n=r.clientY,u=!1},{passive:!0}),t.addEventListener("touchmove",c=>{const r=c.touches[0];r&&Math.hypot(r.clientX-s,r.clientY-n)>8&&(u=!0)},{passive:!0}),t.addEventListener("touchend",()=>{u||T(t,d)}),t.addEventListener("focus",()=>{setTimeout(()=>{T(t,d)},150)})}function J(t){let d,l=[],s=0,n=0;const u=900;let c=!1;const r=100;let w=0,L=0,E=!1;const A=8;let b=0,C=0,y=!1,S=!1;t.setup=function(){t.noCanvas(),d=document.getElementById("carousel"),l=Array.from(document.querySelectorAll(".slide"));const e=document.getElementById("carousel-container");e.style.perspective="2000px",d.style.transformStyle="preserve-3d",window.isMobile=()=>("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768,new MutationObserver(()=>t.refreshSlides&&t.refreshSlides()).observe(d,{childList:!0}),_()?V():O(),t.loop()},t.refreshSlides=function(){l=Array.from(document.querySelectorAll(".slide"))},t.draw=function(){d.style.transform="rotateX(-15deg) rotateY(-30deg)";const a=l.length*u;s=(s+n)%a,s<0&&(s+=a);const f=s/a,i=document.querySelector(".progress-dot");i&&(i.style.backgroundColor=f>=.8?"var(--grey-800)":"rgba(var(--grey-100), 0.4)"),l.forEach((h,B)=>{let g=(B*u-s)%a;g<-u*2&&(g+=a);let X=g-a,x=g+a,m=g;const M=window.innerWidth/2;Math.abs(X-M)<Math.abs(m-M)&&(m=X),Math.abs(x-M)<Math.abs(m-M)&&(m=x);const F=m,H=m*-.5,R=-Math.abs(m)*.2;!h.classList.contains("expanding")&&!h.classList.contains("fullscreen")&&(h.style.transform=`
          translateX(${Math.round(F*100)/100}px)
          translateY(${Math.round(H*100)/100}px)
          translateZ(${Math.round(R*100)/100}px)
        `)});const p=Math.abs(n);let v;if(p>25)v=.88;else if(p>10){const h=(p-10)/15;v=.92+(.88-.92)*h*h*(3-2*h)}else if(p>2)v=.92;else if(p>.5){const h=(p-.5)/1.5;v=.94+(.92-.94)*h}else v=.94;n*=v,Math.abs(n)<.005&&(n=0)};function _(){return("ontouchstart"in window||navigator.maxTouchPoints)&&window.innerWidth<=768}function O(){const e=document.getElementById("carousel-container");if(!e)return;e.addEventListener("wheel",Y,{passive:!1}),e.addEventListener("mousedown",q),e.addEventListener("mouseup",I),e.addEventListener("mousemove",W);const o=document.querySelector("footer, .footer"),a=document.querySelector("header, .header, .site-header");[o,a].forEach(f=>{f&&(f.addEventListener("wheel",i=>{i.stopPropagation(),i.preventDefault()},{passive:!1}),f.addEventListener("mousedown",i=>i.stopPropagation()),f.addEventListener("mousemove",i=>i.stopPropagation()))}),t.mouseWheel=()=>!1,t.mousePressed=()=>!1,t.mouseReleased=()=>!1,t.mouseDragged=()=>!1}function Y(e){e.preventDefault();let o=-e.deltaY/8;o=Math.max(-8,Math.min(8,o));const a=n+o;n+=(a-n)*.6,n=Math.max(-r*.8,Math.min(r*.8,n))}function q(e){e.preventDefault(),c=!0,L=e.clientX}function I(e){e.preventDefault(),c=!1}function W(e){if(!c)return;e.preventDefault();let o=e.clientX-L,a=Math.max(-15,Math.min(15,o*-1.2));n+=(a-n)*.7,n=Math.max(-r*.8,Math.min(r*.8,n)),L=e.clientX}function V(){const e=document.getElementById("carousel-container");e&&(e.addEventListener("touchstart",$,{passive:!1}),e.addEventListener("touchmove",j,{passive:!1}),e.addEventListener("touchend",k,{passive:!1}))}function $(e){e.target.closest("header, .header, .site-header, footer, .footer")||(c=!0,E=!0,y=!1,w=b=e.touches[0].clientX,C=e.touches[0].clientY,n=0,S=!0,setTimeout(()=>S=!1,400),e.preventDefault())}function j(e){if(!E||e.touches.length!==1)return;const o=e.touches[0].clientX,a=o-w;Math.hypot(o-b,e.touches[0].clientY-C)>A&&(y=!0);let f=Math.max(-50,Math.min(50,-a*1.5));n+=(f-n)*.7,w=o,e.preventDefault()}function k(e){if(E){if(!y){const o=e.target.closest(".slide");if(o)if(o.focus({preventScroll:!0}),o.classList.contains("fullscreen"))o.classList.remove("fullscreen");else{const a=[...l].indexOf(o),f=window.stoneData?.[a];f&&U(async()=>{const{openDetail:i}=await import("./openDetail-GWXhpPhG.js");return{openDetail:i}},[]).then(({openDetail:i})=>i(o,f))}}c=!1,E=!1}}const D=e=>{if(e.target.closest("header, .header, .site-header, footer, .footer"))return;const o=document.querySelector(".slide.fullscreen");o&&!e.target.closest(".slide.fullscreen")&&o.classList.remove("fullscreen")};document.addEventListener("touchstart",D,{passive:!0}),document.addEventListener("click",e=>{S||D(e)},{passive:!0})}function P(){document.querySelectorAll("#carousel .slide").length>0?window.p5Instance=new Z(J):setTimeout(P,50)}document.addEventListener("DOMContentLoaded",P);
